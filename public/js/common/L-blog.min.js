/*! blog 10-05-2017 */

var app=angular.module("myApp",[]);app.controller("adminLogin",["$scope","$http",function(a,b){a.login=function(){b({method:"POST",url:"admin/admin_login",data:$.param({adminUser_username:a.adminUser_username,adminUser_password:a.adminUser_password}),headers:{"content-type":"application/x-www-form-urlencoded"}}).then(function(a){1===a.data.code&&(window.location.href="admin/manage")},function(a){})}}]),app.controller("articlesAdd",["$scope","$http",function(a,b){a.articleAdd=function(){var a="";ue.ready(function(){a=ue.getContent(),console.log(a)})}}]),app.controller("categoriesAdd",["$scope","$http",function(a,b){a.cateParentOptions=[{name:"无",id:0},{name:"一级分类",id:1},{name:"二级分类",id:2},{name:"三级分类",id:3}],a.cate_parent=a.cateParentOptions[1].id,a.categoriesAdd=function(){a.myForm.$valid&&b({method:"POST",url:"articles_categories_add",data:$.param({cate_name:a.cate_name,cate_slug:a.cate_slug,cate_order:a.cate_order,cate_parent:a.cate_parent,cate_remark:a.cate_remark}),headers:{"content-type":"application/x-www-form-urlencoded"}}).then(function(a){},function(a){})}}]),app.controller("users",["$scope","$http",function(a,b){b({method:"GET",url:"users2",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(b){a.data=b.data,console.log(a.data)},function(a){})}]),app.controller("usersAdd",function(a,b){a.addAdminUser=function(c){console.log(c);var d=1;switch(a.adminUser_userGroup){case 1:d="超级管理员";break;case 2:d="网站管理员";break;case 3:d="内容管理员";break;case 4:d="投稿员"}if(!c)return!1;b({method:"POST",url:"admin/users_add/add",data:$.param({adminUser_username:a.adminUser_username,adminUser_nickname:a.adminUser_nickname,adminUser_password:a.adminUser_password,adminUser_repassword:a.adminUser_repassword,adminUser_userGroup:d,adminUser_status:a.adminUser_status,adminUser_phone:a.adminUser_phone,adminUser_email:a.adminUser_email,adminUser_remark:a.adminUser_remark}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){},function(a){})},a.userGroupOptions=[{name:"超级管理员",id:1},{name:"网站管理员",id:2},{name:"内容管理员",id:3},{name:"投稿员",id:4}],a.adminUser_userGroup=a.userGroupOptions[0].id,a.statusOptions=[{name:"启用",id:1},{name:"禁用",id:0}],a.adminUser_status=a.statusOptions[0].id,a.checkUsername=function(c){var d=$.trim(c);if(a.isUsernameExist=!1,""==d)return!1;b({method:"POST",url:"users_add/add",data:$.param({adminUser_username:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(b){0==b.data.code&&(a.isUsernameExist=!0)},function(a){})},a.logo="/public/upload/images/defaultlogo.png",$("#adminUser_avatar").uploadify({swf:"/public/plugins/uploadify/uploadify.swf",uploader:"/admin/upload?adminId=adminUser_username&type=images&key=adminUser_avatar",buttonText:"上传图片",buttonClass:"uploadify-btn-default",width:100,height:30,fileTypeDesc:"Image Files",fileTypeExts:"*.gif; *.jpg; *.png",fileSizeLimit:"2000KB",auto:!0,multi:!1,onUploadSuccess:function(a,b,c){$("#adminUser_avatar_preview").attr("src",b)}})}),app.controller("usersGroup",["$scope","$http",function(a,b){b({method:"GET",url:"users_group2",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(b){a.data=b.data},function(a){})}]),app.directive("pwCheck",[function(){return{require:"ngModel",link:function(a,b,c,d){var e="#"+c.pwCheck;b.add(e).on("keyup",function(){a.$apply(function(){var a=b.val()===$(e).val();d.$setValidity("pwmatch",a)})})}}}]),app.directive("pwCheck",[function(){return{require:"ngModel",link:function(a,b,c,d){var e="#"+c.pwCheck;b.add(e).on("keyup",function(){a.$apply(function(){var a=b.val()===$(e).val();d.$setValidity("pwmatch",a)})})}}}]),app.factory("fileReader",["$q","$log",function(a,b){var c=function(a,b,c){return function(){c.$apply(function(){b.resolve(a.result)})}},d=function(a,b,c){return function(){c.$apply(function(){b.reject(a.result)})}},e=function(a,b){var e=new FileReader;return e.onload=c(e,a,b),e.onerror=d(e,a,b),e};return{readAsDataUrl:function(b,c){var d=a.defer();return e(d,c).readAsDataURL(b),d.promise}}}]);