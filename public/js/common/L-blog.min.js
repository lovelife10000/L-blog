/*! blog 11-05-2017 */

var app=angular.module("myApp",[]);app.factory("adminLoginService",["$http",function(a){return{get:function(b,c){return console.log(2),a({method:"POST",url:"admin/admin_login",data:$.param({adminUser_username:b,adminUser_password:c}),headers:{"content-type":"application/x-www-form-urlencoded"}})},find:function(){console.log(3)}}}]),app.factory("articlesAddService",["$http",function(a){return{get:function(b,c,d,e,f,g,h,i,j,k,l,m){a({method:"POST",url:"admin/manage/articles_add",data:$.param({post_title:b,post_from:c,post_display:d,post_tags:e,post_img:f,cate_parent:g,post_keywords:h,post_discription:i,post_type:j,post_view:k,post_author:l,post_content:m}),headers:{"content-type":"applicatin/x-www-form-urlencoded"}})}}}]),app.factory("categoriesAddService",["$http",function(a){return{get:function(b,c,d,e,f){return a({method:"POST",url:"articles_categories_add",data:$.param({cate_name:b,cate_slug:c,cate_order:d,cate_parent:e,cate_remark:f}),headers:{"content-type":"application/x-www-form-urlencoded"}})},getCategories:function(){return a({method:"GET",url:"articles_manage/categories_get",headers:{"content-type":"application/x-www-form-urlencoded"}})}}}]),app.factory("usersService",["$http",function(a){return{get:function(){return a({method:"GET",url:"users_get",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.factory("usersAddService",["$http",function(a){return{get:function(b,c,d,e,f,g,h,i,j){return a({method:"POST",url:"admin/users_add/add",data:$.param({adminUser_username:b,adminUser_nickname:c,adminUser_password:d,adminUser_repassword:e,adminUser_userGroup:f,adminUser_status:g,adminUser_phone:h,adminUser_email:i,adminUser_remark:j}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.factory("usersGroupService",["$http",function(a){return{get:function(){return a({method:"GET",url:"users_group_get",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.factory("usersGroupAddService",["$http",function(a){return{get:function(b,c,d,e,f){return a({method:"POST",url:"users_group_add/add",data:$.param({group_id:b,name:c,pid:d,status:e,remark:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.directive("pwCheck",[function(){return{require:"ngModel",link:function(a,b,c,d){var e="#"+c.pwCheck;b.add(e).on("keyup",function(){a.$apply(function(){var a=b.val()===$(e).val();d.$setValidity("pwmatch",a)})})}}}]),app.controller("adminLogin",["$scope","$http","adminLoginService",function(a,b,c){a.login=function(){c.get(a.adminUser_username,a.adminUser_password).then(function(a){1===a.data.code&&(window.location.href="admin/manage")},function(a){})}}]),app.controller("articlesAdd",["$scope","$http","articlesAddService",function(a,b,c){a.articleAdd=function(){if(myForm.$valid){var b="";ue.ready(function(){b=ue.getContent(),console.log(b)}),c.get(a.post_title,a.post_title,a.post_from,a.post_display,a.post_tags,a.post_img,a.cate_parent,a.post_keywords,a.post_discription,a.post_type,a.post_view,a.post_author,a.post_content).then(function(a){},function(a){})}}}]),app.controller("categoriesAdd",["$scope","$http","categoriesAddService",function(a,b,c){a.cateParentOptions=[{name:"无",id:0},{name:"一级分类",id:1},{name:"二级分类",id:2},{name:"三级分类",id:3}],a.cate_parent=a.cateParentOptions[1].id,c.getCategories().then(function(a){console.log(a.data)},function(a){}),a.categoriesAdd=function(){a.myForm.$valid&&c.get(a.cate_name,a.cate_slug,a.cate_order,a.cate_parent,a.cate_remark).then(function(a){},function(a){})}}]),app.controller("usersGroupAdd",["$scope","$http","usersGroupAddService",function(a,b,c){a.statusOptions=[{name:"启用",id:1},{name:"禁用",id:0}],a.status=a.statusOptions[0].id,a.pidOptions=[{name:"无",id:0},{name:"超级管理员",id:1},{name:"网站管理员",id:2},{name:"内容管理员",id:3},{name:"投稿员",id:4}],a.pid=a.pidOptions[0].id,a.addAdminUserGroup=function(){var b=a.name,d=a.pid,e=a.status,f=a.remark,g="超级管理员";switch(b){case"超级管理员":g=1;break;case"网站管理员":g=2;break;case"内容管理员":g=3;break;case"投稿员":g=4}c.get(g,b,d,e,f).then(function(a){1==a.data.code&&$("#myModal").modal({keyboard:!0})},function(a){})},$("#myModal").on("hidden.bs.modal",function(){window.location="/admin/users_group"}),$("#myModal").on("hide.bs.modal",function(){window.location="/admin/users_group"})}]),app.controller("users",["$scope","$http","usersService",function(a,b,c){c.get().then(function(b){a.data=b.data,console.log(a.data)},function(a){})}]),app.controller("usersAdd",["$scope","$http","usersAddService",function(a,b,c){a.addAdminUser=function(b){var d=1;switch(a.adminUser_userGroup){case 1:d="超级管理员";break;case 2:d="网站管理员";break;case 3:d="内容管理员";break;case 4:d="投稿员"}if(!b)return!1;c.get(a.adminUser_username,a.adminUser_nickname,a.adminUser_password,a.adminUser_repassword,d,a.adminUser_status,a.adminUser_phone,a.adminUser_email,a.adminUser_remark).then(function(a){},function(a){})},a.userGroupOptions=[{name:"超级管理员",id:1},{name:"网站管理员",id:2},{name:"内容管理员",id:3},{name:"投稿员",id:4}],a.adminUser_userGroup=a.userGroupOptions[0].id,a.statusOptions=[{name:"启用",id:1},{name:"禁用",id:0}],a.adminUser_status=a.statusOptions[0].id,a.checkUsername=function(c){var d=$.trim(c);if(a.isUsernameExist=!1,""==d)return!1;b({method:"POST",url:"users_add/add",data:$.param({adminUser_username:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(b){0==b.data.code&&(a.isUsernameExist=!0)},function(a){})},a.logo="/public/upload/images/defaultlogo.png",$("#adminUser_avatar").uploadify({swf:"/public/plugins/uploadify/uploadify.swf",uploader:"/admin/upload?adminId=adminUser_username&type=images&key=adminUser_avatar",buttonText:"上传图片",buttonClass:"uploadify-btn-default",width:100,height:30,fileTypeDesc:"Image Files",fileTypeExts:"*.gif; *.jpg; *.png",fileSizeLimit:"2000KB",auto:!0,multi:!1,onUploadSuccess:function(a,b,c){$("#adminUser_avatar_preview").attr("src",b)}})}]),app.controller("usersGroup",["$scope","$http","usersGroupService",function(a,b,c){function d(){var a=$.fn.zTree.getZTreeObj("treeDemo"),b=$("#py").attr("checked")?"p":"",c=$("#sy").attr("checked")?"s":"",d=$("#pn").attr("checked")?"p":"",f=$("#sn").attr("checked")?"s":"",g={Y:b+c,N:d+f};a.setting.check.chkboxType=g,e('setting.check.chkboxType = { "Y" : "'+g.Y+'", "N" : "'+g.N+'" };')}function e(a){f||(f=$("#code")),f.empty(),f.append("<li>"+a+"</li>")}c.get().then(function(b){a.data=b.data},function(a){}),a.setPower=function(){console.log(1)};var f,g={check:{enable:!0,chkboxType:{Y:"p",N:"s"}},data:{simpleData:{enable:!0}}},h=[{name:"系统管理",open:!0,children:[{name:"用户组管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]},{name:"用户管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]},{name:"广告管理",isParent:!0},{name:"文件管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]},{name:"数据管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]},{name:"日志管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]}]},{name:"内容管理",children:[{name:"文章管理",open:!0,children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]},{name:"分类管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]},{name:"标签管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]},{name:"模版管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]},{name:"评论管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]},{name:"消息管理",children:[{name:"新增"},{name:"查看"},{name:"修改"},{name:"删除"}]}]},{name:"会员管理",isParent:!0}];$(document).ready(function(){$.fn.zTree.init($("#treeDemo"),g,h),d(),$("#py").bind("change",d),$("#sy").bind("change",d),$("#pn").bind("change",d),$("#sn").bind("change",d)})}]);